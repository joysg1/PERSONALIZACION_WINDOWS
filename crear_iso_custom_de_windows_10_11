++ Pasos para crear ISO CUSTOM DE WINDOWS 10/11

- Instalar todo el software que querramos en el windows, app recomendada para hacerlo automatico: https://ninite.com/

- Tener partición de data creada (equivalente a C en tamaño)

- Ejecutar en cmd (administrador):  %windir%\system32\sysprep\sysprep.exe /audit /reboot
sysprep

--- Nota: cuando ejecutamos sysprep debemos tener deshabilitado el update y no tener internet

- El equipo se reiniciará

- Ejecutar sysprep (dejar la opcion de auditoria y reiniciar).

- Eliminar cuentas que no sean de administrador

- Ejecutar sysprep nuevamente (dejar las opciones OOBE, generalize y shutdown)

- Bootear con la ISO y seleccionar la opcion de reparar

- Seleccionar reparar problemas

- Determinar la letra de la instalacion del windows y de la particion de datos.
Ejemplo de ejecucion
c: 
dir
<particion del sistema operativo>

d:
dir
<particion de data>

x:
<volver a la ruta de la iso>

listar todos los volumenes con: diskpart y luego list vol

- Ejecutar el siguiente comando:
dism /capture-image /imagefile:D:\install.wim /capturedir:C:\ /Name:windows

- Tambien es equivalente el siguiente comando:
imagex /capture C: D:\Captura\install.wim "WindowsImage" /compress maximum


- Presionar enter y esperar que el proceso termine 

- Teclear exit y dar clic en continue 

- Ir a la particion de data y verificar que install.win este

- Bajar e instalar el programa anyburn https://www.anyburn.com/

- En anyburn seleccionar la opcion edit image file

- seleccionar la iso 

- eliminar el install.wim de la carpeta sources 

- agregar el install.wim custom 

- seleccionar next y darle nombre a la iso 

- crear la iso y probarla

- Video de referencia: https://www.youtube.com/watch?v=RRUmTxOX1KE

--- Nota: ¿Cómo saber las letras de las unidades?
mediante el comando diskpart y luego list volume

--- Nota: tras las pruebas se notó que el tamaño de la iso generada suele ser muy grande
(proporcionalmente, al número de programas instalados) por ende a largo plazo 
este procedimiento no es tan viable, ya que necesitaría una usb muy grande y tiempos
de carga altos para instalar desde una iso tan grande. 

--- Nota: se notaron múltiples errores al realizar el procedimiento desde virtualbox, el proceso se está llevando a 
cabo desde una instalación local de windows 10 para notar si existen cambios. 

--- Nota: al llevar el proceso en una instalación física de windows 10 (LTSB) el procedimiento tuvo éxito, más algunas licencias 
como la del propio windows y del office como de aplicativos, no se trasladan al instalar la iso resultante. Sí se observaron 
ajustes trasladados, tales como: favoritos de los navegadores, ajustes del windows, etc. 

--- Nota: se llevarán a cabo las pruebas nuevamente con la ISO de Windows 11. 

--- Nota: se esta realizando la prueba con la ISO de Windows 11 haciendo sysprep (modo auditoria) desde que se 
inicia el Windows recien instalado. El proceso tuvo exito de forma parcial, la iso modificada generada con la 
iso oficial no bootea, se hara la prueba con la iso custom (TEU).

--- Nota: el procedimiento ha tenido éxito usando la iso custom (TEU) como base. Ahora se realizarán más pruebas 
instalando más cantidad de software. 

--- Nota: tras instalar el software con ninite (instalador automático) y ejecutar sysprep nos aparecen errores 
ligados a que sysprep no puede continuar debido a que existen errores detectando software que no se ha instalado 
correctamente a todos los usuarios, eso nos lleva a inferir que todo el software que instalemos debe tener 
marcada la opción de instalar para todos los usuarios. 

--- Nota: debemos intentar realizar el procedimiento usando como base la ISO original más reciente de Windows 11.

--- Nota: se ha deshabilitado el copilot a metodo de prueba en windows 11 como tambien las apps usando el tutorial de las
soluciones.

--- Nota: al final se tuvo que recurrir al uso de la ISO modificada para que el proceso fuera exitoso. 


++ TINY CORE BUILDER: https://github.com/ntdevlabs/tiny11builder


++ Cómo eliminar el error de sysprep en la iso 24H2?

-- Ejecutar en prowershell los siguientes comandos despues de poner en auditoría el sistema:
Debemos recordar que el sistema no debe estar conectado a internet

Get-AppxPackage -AllUsers *Microsoft.Copilot*

Remove-AppxPackage -Package Microsoft.Copilot_0.4.2.0_neutral__8wekyb3d8bbwe -AllUsers

--- Nota: si el error continua, debemos seguir eliminando paquetes siguiendo
la sintaxis y tomando el cuenta el paquete indicado según los logs.

--- Nota: el procedimiento fue exitoso usando como base dos isos 24H2, una de un
TEU y otra normal, por ende podemos concluir que los errores anteriormente 
encontrados no tenían su origen en la ISO, sino en la falta de aplicación
del procedimiento encontrado (eliminación de paquetes conflictivos).

--- Nota: debemos de realizar pruebas adicionales, usando una cantidad de programas mayor
y la iso 24H2. 

--- Nota: tras realizar las pruebas adicionales, se ha validado que el procedimiento 
va a mostrar más errores, pero siempre vinculados a paquetes específicos, por ende
la solución está en eliminar uno por uno los paquetes conflictivos y eliminar el archivo de
los logs tras cada eliminación por comando en PowerShell.
++ Sintaxis general del comando: Remove-AppxPackage <nombre_paquete> -AllUsers
++ Debemos recordar que el nombre del paquete aparece en los logs de sysprep.

--- Nota: también es importante señalar que, usando la iso original el procedimiento
falla al probar la iso en máquina virtual tras realizar el procedimiento de modificación de los 
valores del registro para saltar las verificaciones de CPU, RAM y TPM.
Por ende es recomendable usar la ISO custom como base. 

--- Nota: Debemos recordar que el procedimiento tiende a fallar con la ISO original y debemos
de usar la ISO custom. No obstante, hay programas que fallan al abrirse luego de instalar windows, 
tales programas son: jdownloader, math expert calculus assistant

--- Nota: A pesar de lo anteriormente citado, podemos decir que el procedimiento es exitoso. También debemos indicar 
que algunos programas no crean el acceso directo, pero si se busca en la ruta de 
instalacion del windows el programa puede abrirse. 

--- Nota: Realizar el proceso con la version 23H2 ha resultado ser más estable.

--- Nota: Debemos recordar que la ISO custom trae los usuarios como también los archivos
que se coloquen en C. 

--- Nota: Debemos recordar realizar el procedimiento de tratar de actualizar desde la version 23H2 a la 24H2 y 
generar otra ISO como también incluir mas software y el paquete de idioma español. 

--- Nota: El procedimiento de tratar de actualizar desde la versión 23H2 a 24H2 no fue exitoso se
realizó una instalación limpia usando una iso modificada de la versión 24H2.

